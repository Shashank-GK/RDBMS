CREATE DATABASE LIBRARY_BOOKS;
USE LIBRARY_BOOKS;

CREATE TABLE PUBLISHER(NAME VARCHAR (20) PRIMARY KEY, PHONE INTEGER,ADDRESS VARCHAR (20));
SELECT * FROM PUBLISHER;
CREATE TABLE BOOK(BOOK_ID INTEGER NOT NULL PRIMARY KEY, TITLE VARCHAR (20),PUB_YEAR VARCHAR (20),PUBLISHER_NAME varchar(20) REFERENCES PUBLISHER (NAME));
SELECT * FROM BOOK;
CREATE TABLE BOOK_AUTHORS (AUTHOR_NAME VARCHAR (20),BOOK_ID INTEGER REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE, PRIMARY KEY (BOOK_ID, AUTHOR_NAME));
SELECT * FROM BOOK_AUTHORS;
CREATE TABLE LIBRARY_BRANCH (BRANCH_ID INTEGER PRIMARY KEY, BRANCH_NAME VARCHAR (50),ADDRESS VARCHAR (50));
SELECT * FROM LIBRARY_BRANCH;
CREATE TABLE BOOK_COPIES (NO_OF_COPIES INTEGER,BOOK_ID INTEGER REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,BRANCH_ID INTEGER REFERENCES LIBRARY_BRANCH (BRANCH_ID) ON DELETE CASCADE, PRIMARY KEY (BOOK_ID, BRANCH_ID));
SELECT * FROM BOOK_COPIES;
CREATE TABLE CARD(CARD_NO INTEGER PRIMARY KEY);
SELECT * FROM CARD;
CREATE TABLE BOOK_LENDING (DATE_OUT DATE,DUE_DATE DATE,BOOK_ID INTEGER REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,BRANCH_ID INTEGER REFERENCES LIBRARY_BRANCH (BRANCH_ID) ON DELETE CASCADE, CARD_NO INTEGER REFERENCES CARD (CARD_NO) ON DELETE CASCADE,
PRIMARY KEY (BOOK_ID, BRANCH_ID,CARD_NO));
SELECT *FROM BOOK_LENDING;

INSERT INTO PUBLISHER VALUES ('MCGRAW_HILL', 91, 'BANGALORE'),('PEARSON', 98, 'NEWDELHI'),('RANDOM_HOUSE', 74, 'HYDRABAD'), (' HACHETTE_LIVRE', 89, 'MUMBAI'), ('GRUPO_PLANETA', 77, 'BANGALORE');
SELECT * FROM PUBLISHER;
INSERT INTO BOOK VALUES (1,'DBMS','JAN-2017', 'MCGRAW-HILL'),(2,'ADBMS','JUN-2016', 'MCGRAW-HILL'),(3,'CN','SEP-2016', 'PEARSON'),(4,'CG','SEP-2015', 'GRUPO PLANETA'),(5,'OS','MAY-2016', 'PEARSON');
SELECT * FROM BOOK;
INSERT INTO BOOK_AUTHORS VALUES ('NAVATHE', 1),('NAVATHE', 2), ('TANENBAUM', 3),('EDWARD ANGEL', 4),('GALVIN', 5);
SELECT * FROM BOOK_AUTHORS;
INSERT INTO LIBRARY_BRANCH VALUES (10,'RR NAGAR','BANGALORE'), (11,'EWIT','BANGALORE'), (12,'RAJAJI NAGAR', 'BANGALORE'), (13,'NITTE','MANGALORE'), (14,'MANIPAL','UDUPI');
SELECT * FROM LIBRARY_BRANCH;
INSERT INTO BOOK_COPIES VALUES (10, 1, 10),(5, 1, 11),(2, 2, 12),(5, 2, 13),(5, 2, 13),(7, 3, 14),(1, 5, 10),(3, 4, 11);
SELECT * FROM BOOK_COPIES;
INSERT INTO CARD VALUES (100),(101),(102),(103),(104);
SELECT * FROM CARD;
INSERT INTO BOOK_LENDING VALUES ('2021-01-01','2022-01-01', 1, 10, 101),('2021-01-01','2022-01-01', 3, 14, 101), ('2021-01-01','2022-01-01', 2, 13, 101), ('2021-01-01','2022-01-01', 4, 11, 101), ('2021-01-01','2022-01-01', 1, 11, 104); 
SELECT * FROM BOOK_LENDING;

/* Retrieve details of all books in the library â€“ id, title, name of publisher, authors, number of copies in each branch. */
SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, A.AUTHOR_NAME, 
C.NO_OF_COPIES, L.BRANCH_ID
FROM BOOK B, BOOK_AUTHORS A, BOOK_COPIES C, LIBRARY_BRANCH L 
WHERE B.BOOK_ID=A.BOOK_ID
AND B.BOOK_ID=C.BOOK_ID
AND L.BRANCH_ID=C.BRANCH_ID;

/*Delete a book in BOOK table. Update the contents of other tables to reflect this data manipulation operation. */
DELETE FROM BOOK 
WHERE BOOK_ID=3;

/* Partition the BOOK table based on year of publication. Demonstrate its working with a simple query. */
CREATE VIEW V_PUBLICATION AS 
SELECT PUB_YEAR
FROM BOOK;




